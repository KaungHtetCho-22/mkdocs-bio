
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Technical documentation for biodiversity">
      
      
        <meta name="author" content="AIT">
      
      
        <link rel="canonical" href="https://kaunghtetcho-22.github.io/mkdocs-bio/ai/">
      
      
        <link rel="prev" href="../hardware/">
      
      
        <link rel="next" href="../inference/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.20">
    
    
      
        <title>AI Models - Biodiversity Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+3:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Source Sans 3";--md-code-font:"Fira Code"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#biodiversity-score-prediction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Biodiversity Project Documentation" class="md-header__button md-logo" aria-label="Biodiversity Project Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.9 17.39c-.26-.8-1.01-1.39-1.9-1.39h-1v-3a1 1 0 0 0-1-1H8v-2h2a1 1 0 0 0 1-1V7h2a2 2 0 0 0 2-2v-.41a7.984 7.984 0 0 1 2.9 12.8M11 19.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.22.21-1.79L9 15v1a2 2 0 0 0 2 2m1-16A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Biodiversity Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AI Models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../hardware/" class="md-tabs__link">
        
  
    
  
  Hardware Setup

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  AI Models

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../inference/" class="md-tabs__link">
        
  
    
  
  Inference Pipeline

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Biodiversity Project Documentation" class="md-nav__button md-logo" aria-label="Biodiversity Project Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.9 17.39c-.26-.8-1.01-1.39-1.9-1.39h-1v-3a1 1 0 0 0-1-1H8v-2h2a1 1 0 0 0 1-1V7h2a2 2 0 0 0 2-2v-.41a7.984 7.984 0 0 1 2.9 12.8M11 19.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.22.21-1.79L9 15v1a2 2 0 0 0 2 2m1-16A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>

    </a>
    Biodiversity Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../hardware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hardware Setup
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    AI Models
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    AI Models
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#outlines" class="md-nav__link">
    <span class="md-ellipsis">
      Outlines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview-of-biodiversity-score-level-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Overview of Biodiversity Score Level Prediction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    <span class="md-ellipsis">
      Sources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audio-data-labels" class="md-nav__link">
    <span class="md-ellipsis">
      Audio Data Labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Data Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geographic-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      Geographic filtering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-list" class="md-nav__link">
    <span class="md-ellipsis">
      Class list
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sound-classification-model" class="md-nav__link">
    <span class="md-ellipsis">
      Sound Classification Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#biodiversity-score-level-prediction-model" class="md-nav__link">
    <span class="md-ellipsis">
      Biodiversity Score Level Prediction Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inference Pipeline
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="biodiversity-score-prediction">Biodiversity Score Prediction<a class="headerlink" href="#biodiversity-score-prediction" title="Permanent link">&para;</a></h1>
<h2 id="outlines">Outlines<a class="headerlink" href="#outlines" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#ov">Overview</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#models">Models</a></li>
</ul>
<p><a id="ov"></a></p>
<h2 id="overview-of-biodiversity-score-level-prediction"><strong>Overview of Biodiversity Score Level Prediction</strong><a class="headerlink" href="#overview-of-biodiversity-score-level-prediction" title="Permanent link">&para;</a></h2>
<p>This project predicts regional biodiversity scores through a two-stage workflow <a href="#bioscoreoverview">Figure 1</a>: <strong>1. bird and insect sound classification</strong> and the <strong>2. biodiversity score level prediction</strong>.  </p>
<ol>
<li><strong>Bird and Insect Sound Classification</strong><br />
Audio recordings are collected by deployed AudioMoth devices. As illustrated in <a href="#bioscoreoverview">Figure 1</a>, the recordings are preprocessed and fed into a deep learning classifier based on a modified implementation of the <a href="https://www.kaggle.com/competitions/birdclef-2023/writeups/atfujita-4th-place-solution-knowledge-distillation">BirdCLEF 2023 4th Place Solution</a>. The model identifies bird and insect species and also detects non-biological sounds such as human speech, other human-generated noises, and vehicle sounds. It was pre-trained on species recordings from <a href="https://xeno-canto.org/">Xeno-canto</a> and noise/no-call recordings from our own data collection.</li>
<li><strong>Biodiversity Score Level Prediction</strong><br />
For each region, the frequency of occurrence of every detected species and noise class is aggregated from the classified recordings. These frequencies serve as input features to a traditional machine learning model (XGBoost), which predicts the regionâ€™s biodiversity score level: high, medium, or low.  </li>
</ol>
<p><img alt="Overview of Biodiversity Score Level Prediction" src="../images/biodiversity_overview.png" width="400" /></p>
<p><em>Figure 1: Biodiversity Score Level Prediction Overview.</em></p>
<p><a id="data"></a></p>
<h2 id="data"><strong>Data</strong><a class="headerlink" href="#data" title="Permanent link">&para;</a></h2>
<p>This section provides an overview of the data used in this project. We summarize the sources, label quality, use in training, geographic filtering, and the class list.</p>
<h3 id="sources">Sources<a class="headerlink" href="#sources" title="Permanent link">&para;</a></h3>
<p>Public: Expert-labeled wildlife audio from <a href="https://xeno-canto.org/">Xeno-canto</a>, covering birds and insects.
Self-collected: Field recordings captured with AudioMoth devices in tea plantations around Chiang Mai, Thailand.</p>
<h3 id="audio-data-labels">Audio Data Labels<a class="headerlink" href="#audio-data-labels" title="Permanent link">&para;</a></h3>
<p>Xeno-canto recordings include expert-provided species labels.
The self-collected recordings lack ground-truth annotations.</p>
<h3 id="data-usage">Data Usage<a class="headerlink" href="#data-usage" title="Permanent link">&para;</a></h3>
<p>The sound-classification model is trained primarily on the labeled Xeno-canto data.
Additional noise examples from our self-collected recordings (e.g., human speech, noises from human activity, vehicles, and other environmental noises) are included to improve robustness.</p>
<h3 id="geographic-filtering">Geographic filtering<a class="headerlink" href="#geographic-filtering" title="Permanent link">&para;</a></h3>
<p>To reduce label noise and improve relevance, we removed species not known to occur in Thailand, with a particular focus on the Chiang Mai region.</p>
<h3 id="class-list">Class list<a class="headerlink" href="#class-list" title="Permanent link">&para;</a></h3>
<p>The final set of bird and insect species used in training and inference is documented in <strong>species.txt</strong> and <strong>species_count.txt</strong>. The number of classes included in the analysis is summarized in <a href="#table-1">Table 1</a>.</p>
<p><a id="table-1"></a>
Table 1: Summary of the Number of Classes in Training Data  </p>
<table>
<thead>
<tr>
<th>Type of Sound</th>
<th>Class Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bird Species</td>
<td>66</td>
</tr>
<tr>
<td>Insect Species</td>
<td>14</td>
</tr>
<tr>
<td>Noise/No-Call</td>
<td>10</td>
</tr>
<tr>
<td><strong>Total</strong></td>
<td><strong>90</strong></td>
</tr>
</tbody>
</table>
<hr />
<p><a id="models"></a></p>
<h2 id="models"><strong>Models</strong><a class="headerlink" href="#models" title="Permanent link">&para;</a></h2>
<h3 id="sound-classification-model">Sound Classification Model<a class="headerlink" href="#sound-classification-model" title="Permanent link">&para;</a></h3>
<p>The audio classification model is adapted from <a href="https://www.kaggle.com/competitions/birdclef-2023/writeups/atfujita-4th-place-solution-knowledge-distillation">4th Place Solution: Knowledge Distillation Is All You Need</a>. The modified version of the model can be found at <a href="https://github.com/diwas-lamsal/biodiversity-audio?tab=readme-ov-file">Biodiversity Audio Classification</a>.</p>
<ul>
<li><strong>Input:</strong></li>
<li>Each collected raw audio file contains 10 minutes length which is then splitted into 20 second-chunks. Mel-spectrograms (<a href="#melspectrogram">Figure 2</a>) are extracted from audio chunks and they serve as the input of the audio classification model training.</li>
</ul>
<p><img alt="Mel Spectrogram" src="../images/mel_spectrogram.png" width="600" /></p>
<p><em>Figure 2: An Example of Mel Spectrogram.</em></p>
<ul>
<li><strong>Model Backbone:</strong></li>
<li>Convolutional Neural Networks (CNNs) for spatial feature learning. eg. ResNet, EfficientNet.</li>
<li><strong>Training Details:</strong></li>
<li>Optimizer: <em>AdamW</em></li>
<li>Loss: <em>BCEWithLogitsLoss</em></li>
<li>Learning Rate: <em>2.5e-4 (with Cosine Learning Rate Scheduler)</em></li>
<li>Epochs: <em>200</em></li>
<li>Batch Size: <em>32</em></li>
<li><strong>Output:</strong></li>
<li>The model produces a prediction indicating the class ID of the species with the highest probability in the input audio chunk. The class IDs range from 0 to 89 (totaling 90 classes), and the final prediction maps the class ID to the corresponding species name.</li>
</ul>
<h3 id="biodiversity-score-level-prediction-model">Biodiversity Score Level Prediction Model<a class="headerlink" href="#biodiversity-score-level-prediction-model" title="Permanent link">&para;</a></h3>
<p>The biodiversity score level is categorized into low, medium and high according to the location of the area from which we map them into class IDs of 0 to 2 respectively. We use XGBoost Classification Model to predict the final biodiversity score level. The training and validation datasets are split based on device ID to ensure that recordings from the same device do not appear in both sets, thereby preventing data leakage and maintaining the integrity of the validation process.</p>
<ul>
<li><strong>Input:</strong></li>
<li>The outputs from the audio classification model, along with their respective timestamps, are converted into a pivot table, <a href="#table-2">Table 2</a>, based on frequency count, with each column representing a species name or noise classification. From this pivot table, we extract the frequency of occurrence for each species at specific timestamps. These occurrences are then aggregated into hourly counts for each species. The final input is a table displaying the hourly appearance of each species, which is mapped to its corresponding biodiversity score level, <a href="#table-3">Table 3</a>.</li>
</ul>
<p><a id="table-2"></a>
Table 2: Example of Pivot Table for Species Frequency Count  </p>
<table>
<thead>
<tr>
<th>No</th>
<th>unique_date</th>
<th>collected_biodiversity_score</th>
<th>hour</th>
<th>species_1</th>
<th>species_2</th>
<th>...</th>
<th>species_x</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>model5_2025-01-27</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>...</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>model4_2025-01-28</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>model1_2025-01-29</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>2</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Training Details:</strong></li>
<li>Model: XGBoost Classifier</li>
<li>Hyperparameter Search: GridSearch</li>
<li>
<p>Best Num Features: 60</p>
</li>
<li>
<p><strong>Training</strong></p>
</li>
<li>The detailed training settings and codebase can be found in <a href="../files/score_prediction_training.ipynb"><code>score_prediction_training.ipynb</code></a></li>
<li>Required resources are provided in <a href="../files/score-prediction-training-resources.zip"><code>training_resources.zip</code></a></li>
</ul>
<p><a id="table-3"></a>
Table 3: Mapping Between Biodiversity Score Level and Class ID  </p>
<table>
<thead>
<tr>
<th>Biodiversity Score Level</th>
<th>Class ID</th>
</tr>
</thead>
<tbody>
<tr>
<td>Low</td>
<td>0</td>
</tr>
<tr>
<td>Medium</td>
<td>1</td>
</tr>
<tr>
<td>High</td>
<td>2</td>
</tr>
</tbody>
</table>
<hr />












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.instant", "toc.integrate", "content.code.copy", "content.tabs.link", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
    
  </body>
</html>